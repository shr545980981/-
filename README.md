# 变分法在遥感图像去噪中的应用

**Application of Variational Methods in Remote Sensing Image Denoising**

---

## 摘要

高光谱遥感图像在获取过程中不可避免地受到传感器噪声、电子链路误差以及探测器响应不一致等因素的影响，导致图像质量下降。图像去噪作为遥感数据预处理中的关键环节，直接影响后续定量反演与应用分析的可靠性。本文以珠海一号卫星高光谱数据为研究对象，引入变分法框架下的全变分（Total Variation, TV）模型，对遥感图像去噪问题进行建模与求解。通过构造能量泛函并推导欧拉–拉格朗日方程，结合有限差分方法实现离散求解，验证了该方法在边缘保持与噪声抑制之间的有效平衡能力。实验结果表明，该方法在仿真数据和真实遥感影像上均取得了良好的去噪效果。

---

## 第一部分：研究背景与数学主题定位

### 1. 研究主题与核心目标

本文研究聚焦于**珠海一号卫星高光谱遥感数据（OHS）**的预处理问题。OHS 数据处理流程通常包括：

* L0 级数据解压与格式化；
* L1 级数据预处理（辐射定标、去噪、条带校正等）；
* L2 级数据应用处理。

其中，**L1 级数据去噪**是影响数据质量的关键步骤。本文的核心目标在于：

> 构建一套基于现代数学理论的图像去噪模型，在有效降低噪声的同时尽可能保持遥感影像的边缘与结构信息，为后续定量分析奠定基础。

---

### 2. 现代数学可解决的关键挑战

传统图像去噪方法（如均值滤波、高斯滤波）在实际工程应用中面临以下局限：

* 噪声抑制与边缘保持之间存在天然矛盾；
* 参数选择高度依赖经验；
* 缺乏统一的理论最优性解释。

因此，有必要引入**严格的数学建模与优化框架**，将图像去噪问题转化为可分析、可求解的最优化问题。

---

### 3. 数学主题选择与理由

本文选择**泛函分析**作为理论基础，重点采用**变分法**进行建模与求解，理由如下：

* 全变分能量泛函可同时度量图像的保真性与正则性；
* 变分法天然适合描述“最优图像”问题；
* 差分离散后可高效实现工程计算。

相比之下：

* 测度论更偏向集合与概率结构；
* 抽象代数无法直接描述图像空间中的连续变化。

---

## 第二部分：核心数学概念

### 1. 变分法基本概念

**变分法（Calculus of Variations）**是一类研究泛函极值问题的数学方法。其目标是在给定函数空间中，寻找使泛函取得极值的函数。

一般形式为：

$$
J[u] = \int_{\Omega} L(x, u, \nabla u) , dx
$$

其中：

* $u$ 为待求函数；
* $L$ 为拉格朗日函数；
* $\Omega$ 为定义域。

---

### 2. 欧拉–拉格朗日方程

通过对泛函 $J[u]$ 进行变分，并令一阶变分为零，可得到欧拉–拉格朗日方程：

$$
\frac{\partial L}{\partial u} - \nabla \cdot \left( \frac{\partial L}{\partial \nabla u} \right) = 0
$$

该方程为变分问题取得极值的必要条件，是后续数值求解的理论基础。

---

### 3. 学习过程与 AI 辅助

相较于传统微积分，变分法的抽象程度更高，需要在泛函空间中重新理解“微分”的含义。本文学习过程中，结合教材、工程案例及 AI 辅助推导，对变分法在最速降线、最优控制等问题中的应用进行了系统理解，为图像去噪建模提供了理论支撑。

---

## 第三部分：变分法在遥感图像去噪中的应用

### 1. 问题建模

设受噪声污染的图像为：

$$
f = u + n
$$

其中：

* $f$ 为观测图像；
* $u$ 为真实图像；
* $n$ 为噪声。

采用全变分（TV）模型构造能量泛函：

$$
E(u) = \int_{\Omega} |\nabla u| , dx + \lambda \int_{\Omega} (u - f)^2 , dx
$$

其中：

* 第一项为正则项（边缘保持）；
* 第二项为保真项（数据一致性）；
* $\lambda$ 为权衡参数。

---

### 2. 欧拉–拉格朗日方程推导

对能量泛函求变分，可得对应的欧拉–拉格朗日方程：

$$

* \nabla \cdot \left( \frac{\nabla u}{|\nabla u|} \right) + 2\lambda (u - f) = 0
  $$

---

### 3. 数值求解方法

采用**有限差分法**对梯度与散度项进行离散，并通过迭代方式求解最优解。边界条件采用重复填充方式处理，以保证数值稳定性。

---

### 4. 实验结果与分析

#### 仿真图像实验

通过改变保真系数 $\lambda$ 与迭代次数，对 PSNR、SSIM 及能量函数进行评估。结果表明：

* 较大 $\lambda$ 时，保真能力强，去噪效果有限；
* 较小 $\lambda$ 时，正则项主导，噪声抑制明显；
* 能量函数随迭代次数单调下降，符合变分法理论。

> 图像位置：`docs/images/fig1.png`、`docs/images/fig2.png`

---

#### 遥感影像实验

在珠海一号遥感影像上测试结果显示：

* 海岸线与地物边缘结构保持良好；
* 高亮区域噪声显著降低；
* 兼顾了噪声抑制与地物可辨识性。

> 图像位置：`docs/images/fig3.png`

---

## 第四部分：反思与展望

### 1. 学习反思

相较于依赖经验的工程方法，基于变分法的数学建模为问题提供了明确的优化目标和理论解释，有助于提升问题求解的系统性与可解释性。

---

### 2. 后续研究方向

未来将进一步探索：

* 泛函分析在嵌入式端优化计算中的应用；
* 变分模型与 AI 网络结构的融合；
* GPU 加速下的实时遥感图像处理方法。

---

## 致谢

感谢现代数学课程与相关资料为本文研究提供的理论基础。
